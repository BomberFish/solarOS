const DLFEATURES=["css","jsxLiterals","usestring","stores"],DLVERSION="0.0.24";!function(e){class t extends Error{constructor(e){super("[dreamland-js/dev] "+e),this.name="DreamlandDevError"}}function n(e,n){e||function(e){throw new t("fatal: "+e)}(n)}const[r,s,o,l,i,a,c]=Array.from(Array(7),Symbol),f="dlcomponent";var u=Object.freeze({__proto__:null,IF:a,LISTENERS:i,PROXY:o,STATEHOOK:c,STEPS:l,TARGET:s,USE_COMPUTED:r,cssBoundary:f});const d={};let p;function m(){if(p)return!0;const e=document.createElement("style");e.textContent="@scope (.test) { :scope { color: red } }",document.head.appendChild(e);const t=document.createElement("div");t.className="test",document.body.appendChild(t);const n=getComputedStyle(t).color;return document.head.removeChild(e),document.body.removeChild(t),p="rgb(255, 0, 0)"==n,p}const h=50;function b(){return`${Array(4).fill(0).map((()=>Math.floor(36*Math.random()).toString(36))).join("")}`}const y=e=>function(t,...n){let r="";for(let e of t)r+=e+(n.shift()||"");return v("dl"+b(),r,e)},g=y(!1),$=y(!0);function v(e,t,n){let r=d[t];if(r)return r;d[t]=e;const s=document.createElement("style");document.head.appendChild(s);let o="",l="";for(t+="\n";;){let[e,...n]=t.split("\n");if(e.trim().endsWith("{"))break;if(l+=e+"\n",!(t=n.join("\n")))break}s.textContent=t;let i=!0;if(i=m(),n&&i){let t="";for(const n of s.sheet.cssRules)n.selectorText||n.media?n.selectorText?.startsWith(":")?(n.selectorText=`.${e}${n.selectorText}`,t+=n.cssText):o+=n.cssText:t+=n.cssText;s.textContent=`.${e} {${l}} @scope (.${e}) to (:not(.${e}).${f} *) { ${o} } ${t}`}else{let t="";n&&!i&&(t=function(e){let t=`:not(${e}).${f}`,n=(r,s)=>`${r} *${s>h?"":`:not(${n(r+" "+(s%2==0?e:t),s+1)})`}`;return`:not(${n(t,0)})`}(`.${e}`));const r=n=>{n.selectorText&&(n.selectorText=n.selectorText.split(",").map((n=>"&"===(n=n.trim())[0]?`.${e}${n.slice(1)}${t}`:":"===n[0]?`.${e}${n}${t}`:`.${e} ${n}${t}`)).join(", ")),o+=n.cssText};for(const e of s.sheet.cssRules)e.media&&e.media.mediaText?(o+=`@media(${e.media.mediaText}){`,Array.from(e.cssRules).map(r),o+="}"):r(e);s.textContent=`.${e} {${l}}${o}`}return e}let E=document;const x=Symbol();let w=!1;Object.defineProperty(window,"use",{get:()=>(w=!0,(e,t,...i)=>{if(e instanceof Array)return S(e,t,...i);n(N(e)||k(e),"a value was passed into use() that was not part of a stateful context"),w=!1;let a={get value(){return function(e){let t=e[o],n=t[l],i=e[r],a=t[s];for(let e of n)if(a=a[e],!L(a))break;for(let e of i)a=e(a);return a}(a)}};if(k(e)){let n=[...e[r]];t&&n.push(t),a[o]=e[o],a[r]=n}else a[o]=e,a[r]=t?[t]:[];return a})}),Object.defineProperty(window,"useChange",{get:()=>(w=!0,(e,t)=>{w=!1,e=e instanceof Array?e:[e];for(let r of e)n(N(r)||k(r),"a value was passed into useChange() that was not part of a stateful context"),_(use(r),t)})});const S=(e,...t)=>{w=!1;let n=O({});const r=[];for(const s in e)if(r.push(e[s]),t[s]){let e=t[s];if(N(e)&&(e=use(e)),k(e)){const t=r.length;let s;_(use(e),(e=>{r[t]=String(e);let o=r.join("");o!=s&&(n.string=o),s=o}))}else r.push(String(e))}return n.string=r.join(""),use(n.string)};let T=new Map;function O(e){n(L(e),"$state() requires an object"),e[i]=[],e[s]=e;let t=Symbol.toPrimitive,a=new Proxy(e,{get(e,n,i){if(w){let a=Symbol(),c=new Proxy({[s]:e,[o]:i,[l]:[n],[t]:()=>a},{get:(e,n)=>[s,o,l,r,t].includes(n)?e[n]:(n=T.get(n)||n,e[l].push(n),c)});return T.set(a,c),c}return Reflect.get(e,n,i)},set(e,t,n){let r=Reflect.set(e,t,n);for(let r of e[i])r(e,t,n);return e[c]&&e[c](e,t,e[t]),r}});return a}let L=e=>e instanceof Object,j=e=>"function"==typeof e;function A(e){return L(e)&&i in e}function N(e){return L(e)&&l in e}function k(e){return L(e)&&r in e}function _(e,t){n(k(e),"handle() requires a stateful object"),n(j(t),"handle() requires a callback function");let a,c=e[o],f=e[r],u=[];function d(){let e=c[s];for(a of u)if(e=e[a],!L(e))break;for(let t of f)e=t(e);t(e)}let p=(e,t)=>function n(r,o,l){if(o===u[t]&&e===r&&(d(),L(l))){let e=l[i];e&&!e.includes(n)&&e.push(p(l[s],t+1))}};for(let e in c[l]){let t=c[l][e];L(t)&&t[s]?_(t,(t=>{u[e]=t,d()})):u[e]=t}let m=p(c[s],0);c[s][i].push(m),m(c[s],u[0],c[s][u[0]])}function R(e,t,n){let r,s,o,l;_(e,(e=>{o=s?.[0],o&&(r=o.previousSibling||(l=o.parentNode)),s&&s.forEach((e=>e.remove())),s=P(n?e?n.then:n.otherwise:e,(e=>{r?(l?(r.prepend(e),l=null):r.after(e),r=e):t(e)}))}))}let C=e=>t=>{let n=e[o],r=e[l],s=0;for(;s<r.length-1;s++)if(n=n[r[s]],!L(n))return;n[r[s]]=t};function D(e,t,...r){if(e==x)return r;if("function"==typeof e){let s=O(Object.create(e.prototype));for(let e in t){let r=t[e];if(e.startsWith("bind:")){n(k(r),"bind: requires a reference pointer from use");let l=C(r[o]),i=e.substring(5);if("this"==i)l(s);else{let e=!1;_(r,(t=>{e?e=!1:(e=!0,s[i]=t)})),_(use(s[i]),(t=>{e?e=!1:(e=!0,l(t))}))}delete t[e]}}Object.assign(s,t),s.children=[];for(let e of r)P(e,s.children.push.bind(s.children));let l=e.apply(s);n(!(l instanceof Array),"Functional component cannot return a Fragment"),n(l instanceof Node,"Functional component must return a Node"),n(!("$"in l),"Functional component cannot have another functional component at root level"),l.$=s,s.root=l;let i=l.classList,a=s.css,c=e.name.replaceAll("$","-");return a&&i.add(v(`${c}-${b()}`,a,!0)),s._leak||i.add(f),l.setAttribute("data-component",e.name),"function"==typeof s.mount&&s.mount(),l}let s=t?.xmlns,l=s?E.createElementNS(s,e):E.createElement(e);for(let e of r){P(e,l.append.bind(l))}if(!t)return l;((e,n)=>{if(!(e in t))return;n(t[e]),delete t[e]})("class",(e=>{if(n("string"==typeof e||e instanceof Array||k(e),"class must be a string or ar ray (r pointer)"),"string"!=typeof e)if(k(e)){let t="";_(e,(e=>{for(let e of t.split(" "))e&&l.classList.remove(e);if("string"==typeof e){for(let t of e.split(" "))t&&l.classList.add(t);t=e}}))}else{window.dlwarnedclassarrays||(console.error("WARN: class arrays (eg, <div class={['container', 'flex']} />) are deprecated and will be REMOVED in the next release"),window.dlwarnedclassarrays=!0);for(let t of e)if(k(t)){let e=null;_(t,(t=>{"string"==typeof e&&l.classList.remove(e),l.classList.add(t),e=t}))}else l.classList.add(t)}else l.setAttribute("class",e)}));for(let e in t){let r=t[e];if(e.startsWith("bind:")){n(k(r),"bind: requires a reference pointer from use");let s=e.substring(5),i=C(r[o]);"this"==s?i(l):"value"==s?(_(r,(e=>l.value=e)),l.addEventListener("change",(()=>i(l.value)))):"checked"==s&&(_(r,(e=>l.checked=e)),l.addEventListener("click",(()=>i(l.checked)))),delete t[e]}if(e.startsWith("class:")){let n=e.substring(6);k(r)?_(r,(e=>{e?l.classList.add(n):l.classList.remove(n)})):r&&l.classList.add(n),delete t[e]}if("style"==e&&L(r)&&!k(r)){for(let e in r){let t=r[e];k(t)?_(t,(t=>l.style[e]=t)):l.style[e]=t}delete t[e]}}for(let e in t){let n=t[e];k(n)?_(n,(t=>{F(l,e,t)})):F(l,e,n)}return s&&(l.innerHTML=l.innerHTML),l}function P(e,t){let n,r,s;if(k(e))R(e,t);else{if(!L(e)||!(a in e)){if(e instanceof Node)return t(e),[e];if(e instanceof Array){for(n of(r=[],e))r=r.concat(P(n,t));return r[0]||(r=P("",t)),r}return null==e&&(e=""),s=E.createTextNode(e),t(s),[s]}R(e[a],t,e)}}function F(e,t,r){if(!r&&e.hasAttribute(t)&&e.removeAttribute(t),r)if(t.startsWith("on:")){n("function"==typeof r,"on: requires a function");let s=t.substring(3);for(let t of s.split("$"))e.addEventListener(t,((...t)=>{self.$el=e,r(...t)}))}else e.setAttribute(t,r)}var I;window.DREAMLAND_SECRET_DEV_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={...u,isDLPtrInternal:N,handle:_},I="Version: 0.0.24",console.log("[dreamland-js/dev] "+I),console.warn("This is a DEVELOPER build of dreamland.js. It is not suitable for production use."),console.info("Enabled features:",DLFEATURES.join(", ")),e.$if=function(e,t,n){return n??=E.createTextNode(""),k(e)?{[a]:e,then:t,otherwise:n}:e?t:n},e.$state=O,e.$store=function(e,{ident:t,backing:r,autosave:o}){let l,i;if("string"==typeof r)if("localstorage"===r)l=()=>localStorage.getItem(t),i=(e,t)=>{localStorage.setItem(e,t)};else n("Unknown store type: "+r);else({read:l,write:i}=r);let a=()=>{console.info("[dreamland.js]: saving "+t);let r={},s=0,o=e=>{let t={stateful:A(e),values:{}},l=s++;r[l]=t;for(let r in e){let s=e[r];if(!k(s))switch(typeof s){case"string":case"number":case"boolean":case"undefined":t.values[r]=JSON.stringify(s);break;case"object":if(s instanceof Array){t.values[r]=s.map((e=>"object"==typeof e?o(e):JSON.stringify(e)));break}null===s?t.values[r]="null":(n(s.__proto__===Object.prototype,"Only plain objects can be serialized in stores"),t.values[r]=o(s));break;case"symbol":case"function":case"bigint":n("Unsupported type: "+typeof s)}}return l};o(e);let l=JSON.stringify(r);i(t,l)},f=(e,t,n)=>{A(n)&&(n[s][c]=f),a()},u=JSON.parse(l(t));if(u){let t={},n=e=>{if(t[e])return t[e];let r=u[e],s={};for(let e in r.values){let t=r.values[e];s[e]="string"==typeof t?JSON.parse(t):t instanceof Array?t.map((e=>"string"==typeof e?JSON.parse(e):n(e))):n(t)}r.stateful&&"auto"==o&&(s[c]=f);let l=r.stateful?O(s):s;return t[e]=l,l};e=n(0)}switch(o){case"beforeunload":addEventListener("beforeunload",a);break;case"manual":break;case"auto":e[c]=f;break;default:n("Unknown autosave type: "+o)}return O(e)},e.Fragment=x,e.css=g,e.h=D,e.html=function(e,...t){e=[...e];let r="",s={};for(let n=0;n<e.length;n++){let o=e[n],l=t[n],i=t[n]instanceof Function&&/^ *\/>/.exec(e[n+1]);if(/< *$/.test(o)&&i&&(e[n+1]=e[n+1].substr(i.index+i[0].length)),r+=o,n<t.length){let e,t=Object.values(s).findIndex((e=>e===l));-1!==t?e=Object.keys(s)[t]:(e="h"+b(),s[e]=l),r+=e,i&&(r+=`></${e}>`)}}let o=(new DOMParser).parseFromString(r,"text/html");return n(1==o.body.children.length,"html builder needs exactly one child"),function e(t){let n=t.nodeName.toLowerCase();if("#text"===n)return t.textContent;n in s&&(n=s[n]);let r=[...t.childNodes].map(e);for(let e=0;e<r.length;e++){let t=r[e];if("string"==typeof t)for(const[n,o]of Object.entries(s)){if(!t)break;if(!t.includes(n))continue;let s;[s,t]=t.split(n),r=[...r.slice(0,e),s,o,t,...r.slice(e+1)],e+=2}}let o={};if(!t.attributes)return t;for(const e of[...t.attributes]){let t=e.nodeValue;t in s&&(t=s[t]),o[e.name]=t}return D(n,o,r)}(o.body.children[0])},e.isDLPtr=k,e.isStateful=A,e.scope=$}(window);